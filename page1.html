<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>YourFashion — Онлайн магазин (Men/Women/Kids)</title>
<meta name="description" content="YourFashion — модерни колекции за нея, него и деца. Бърза доставка, преглед и тест, лесен checkout." />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
<style>
/* ============ THEME ============ */
:root{
  --bg:#ffffff; --fg:#0f172a; --muted:#f1f5f9; --muted-2:#eef2f7; --line:#e2e8f0;
  --brand:#111827; --accent:#ff2f4b; --accent2:#2563eb; --ok:#16a34a; --warn:#f59e0b; --err:#ef4444;
  --container:1220px; --r:16px; --shadow:0 10px 28px rgba(0,0,0,.08);
}
*{box-sizing:border-box}
html,body{margin:0;color:var(--fg);background:var(--bg);font:500 16px/1.6 'Inter',system-ui,-apple-system,Segoe UI,Roboto,Arial}
img{max-width:100%;display:block}
a{text-decoration:none;color:inherit}
button{cursor:pointer}
.container{max-width:var(--container);margin:0 auto;padding:0 16px}
.muted{color:#64748b}
.hidden{display:none !important}
.visually-hidden{position:absolute !important;height:1px;width:1px;overflow:hidden;clip:rect(1px,1px,1px,1px);white-space:nowrap}

/* Buttons */
.btn{border:0;background:#111;color:#fff;border-radius:12px;padding:10px 14px;font-weight:700;transition:.18s transform ease}
.btn:active{transform:translateY(1px)}
.btn--light{background:#fff;color:#111;border:1px solid var(--line)}
.btn--ghost{background:#fff;color:#111;border:1px solid var(--line)}
.btn--accent{background:linear-gradient(90deg,var(--accent2),var(--accent));color:#fff;border:0}
.btn--danger{background:var(--err);color:#fff}
.btn--ok{background:var(--ok);color:#fff}
.flex-1{flex:1}.w-100{width:100%}

/* Chips / pills */
.chip{display:inline-flex;align-items:center;gap:8px;padding:6px 12px;border:1px solid var(--line);border-radius:999px;background:#fff}
.chip.is-active,.chip:hover{background:var(--muted)}

/* Topbar */
.topbar{background:#111;color:#fff;font-size:14px}
.topbar__inner{display:flex;justify-content:space-between;gap:10px;padding:8px 0}
.brand-dot{display:inline-block;width:8px;height:8px;border-radius:50%;background:#fff;margin-right:8px}
.link{color:#fff;opacity:.9}.link:hover{opacity:1}

/* Header / Nav */
.header{position:sticky;top:0;z-index:50;background:#fff;border-bottom:1px solid var(--line)}
.header__inner{display:grid;grid-template-columns:auto 1fr auto;align-items:center;gap:16px;padding:14px 0}
.brand{display:flex;align-items:center;gap:12px}
.brand__logo{width:48px;height:48px;border-radius:12px;background:#111;display:grid;place-items:center;color:#fff;font-weight:800;letter-spacing:.5px}
.brand__text{line-height:1}
.brand__top{font-size:14px;color:#6b7280}
.brand__bottom{font-size:20px;font-weight:800}
.menu{display:flex;gap:18px;justify-content:center;align-items:center;flex-wrap:wrap}
.menu__link{padding:8px 10px;border-radius:10px;color:#111}
.menu__link.active,.menu__link:hover{background:var(--muted)}
.header__actions{display:flex;align-items:center;gap:10px}
.search{display:flex;align-items:center;gap:8px;border:1px solid var(--line);border-radius:12px;padding:8px 12px;background:#fff}
.search input{border:0;outline:0;width:220px}
.cart-btn{position:relative;background:#fff;color:#111;border:1px solid var(--line)}
.cart-btn__count{position:absolute;top:-8px;right:-8px;background:var(--accent);color:#fff;border-radius:999px;font-size:12px;min-width:18px;text-align:center;padding:2px 5px;border:2px solid #fff}
.burger{display:none;background:#fff;color:#111;border:1px solid var(--line)}
@media (max-width:980px){ .menu{display:none} .burger{display:block} .search input{width:140px} }

/* Gender tiles */
.gender__grid{display:grid;grid-template-columns:1fr 1fr;gap:16px;padding:20px 0}
@media (max-width:980px){.gender__grid{grid-template-columns:1fr}}
.tile{position:relative;border-radius:18px;overflow:hidden;box-shadow:var(--shadow);border:1px solid var(--line)}
.tile img{width:100%;height:300px;object-fit:cover}
.tile__label{position:absolute;left:16px;top:16px;background:#fff;border-radius:999px;padding:8px 14px;font-weight:800}
.tile__bottom{position:absolute;left:0;right:0;bottom:0;padding:16px;background:linear-gradient(180deg,transparent,rgba(0,0,0,.65));color:#fff}
.pill-row{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
.pill{background:#fff;color:#111;border-radius:999px;padding:6px 12px;font-weight:700}
.pill:hover{background:#111;color:#fff}
/* Kids wide tile */
.tile--kid{grid-column:1/3;height:200px}
.tile--kid img{height:200px;object-fit:cover}
@media (max-width:980px){.tile--kid{grid-column:auto}}

/* Info strip */
.info{background:#0f172a;color:#e5e7eb}
.info__grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;padding:18px 0}
@media (max-width:900px){.info__grid{grid-template-columns:1fr}}
.ibox{background:#111827;border:1px solid #222;border-radius:14px;padding:14px;display:flex;gap:12px;align-items:center}

/* Section header + filters */
.section__head{display:flex;align-items:center;justify-content:space-between;gap:10px;margin:26px 0 12px}
.filters{display:flex;gap:10px;flex-wrap:wrap}
.filters select{border:1px solid var(--line);border-radius:10px;padding:8px 10px;background:#fff;color:#111}

/* Product grid */
.grid{display:grid;grid-template-columns:repeat(4,1fr);gap:14px}
@media (max-width:1100px){.grid{grid-template-columns:repeat(3,1fr)}}
@media (max-width:760px){.grid{grid-template-columns:repeat(2,1fr)}}
@media (max-width:520px){.grid{grid-template-columns:1fr}}
.card{border:1px solid var(--line);border-radius:16px;overflow:hidden;background:#fff;box-shadow:var(--shadow);display:flex;flex-direction:column}
.thumb{position:relative;aspect-ratio:1/1;background:#f8fafc}
.card .badge{left:10px;top:10px}
.body{padding:12px}
.sizes{display:flex;gap:6px;color:#6b7280;font-size:13px;margin-top:6px;flex-wrap:wrap}
.price{display:flex;align-items:center;gap:8px;margin-top:8px}
.price--lg{margin:10px 0 12px}
.price__now{font-weight:800}
.price__old{text-decoration:line-through;color:#9ca3af}
.cta-row{display:flex;gap:8px;margin-top:auto;padding:12px}
.btn-sm{flex:1;background:#111;color:#fff;border:0;border-radius:10px;padding:10px;font-weight:700}
.btn-sm.ghost{background:#fff;color:#111;border:1px solid var(--line)}

/* Skeletons for loading */
.skel{position:relative;overflow:hidden;background:var(--muted-2)}
.skel::after{content:"";position:absolute;inset:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,.6),transparent);transform:translateX(-100%);animation:sh 1.4s infinite}
@keyframes sh{to{transform:translateX(100%)}}

/* Instagram */
.insta__inner{padding:26px 0}
.insta__head{display:flex;align-items:center;gap:8px;margin-bottom:8px}
.insta__row{display:grid;grid-template-columns:repeat(6,1fr);gap:8px}
@media (max-width:900px){.insta__row{grid-template-columns:repeat(3,1fr)}}
.insta__row img{height:180px;object-fit:cover;border-radius:12px;border:1px solid var(--line)}

/* Newsletter */
.newsletter{background:#f8fafc;border-top:1px solid var(--line);border-bottom:1px solid var(--line)}
.newsletter__inner{padding:20px 0;display:grid;grid-template-columns:1fr auto;gap:16px;align-items:center}
@media (max-width:760px){.newsletter__inner{grid-template-columns:1fr}}
.newsletter input{border:1px solid var(--line);border-radius:10px;padding:10px 12px;width:260px;background:#fff;color:#111}

/* Footer */
.footer{background:#0f172a;color:#e5e7eb}
.footer__grid{padding:26px 0;display:grid;grid-template-columns:2fr 1fr 1fr 1fr;gap:16px}
@media (max-width:1000px){.footer__grid{grid-template-columns:1fr 1fr}}
@media (max-width:640px){.footer__grid{grid-template-columns:1fr}}
.f-title{font-weight:800;margin-bottom:8px;color:#fff}
.f-link{display:block;color:#cbd5e1;padding:4px 0}
.f-link:hover{color:#fff}
.copy{border-top:1px solid #1f2937;padding:12px 0;color:#94a3b8;text-align:center}

/* Modal (Quick View) */
.modal{position:fixed;inset:0;display:none;z-index:70}
.modal.open{display:block}
.modal__backdrop{position:absolute;inset:0;background:rgba(0,0,0,.55)}
.modal__card{position:absolute;inset:auto 50% 0 50%;transform:translate(-50%,0);width:min(980px,96vw);background:#fff;border:1px solid var(--line);border-radius:20px 20px 0 0;padding:16px;box-shadow:var(--shadow)}
@media (min-width:980px){.modal__card{inset:50% 50% auto 50%;transform:translate(-50%,-50%);border-radius:20px}}
.modal__head{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.modal__grid{display:grid;grid-template-columns:1fr 1fr;gap:16px}
@media (max-width:920px){.modal__grid{grid-template-columns:1fr}}
.modal__media img{border-radius:16px;border:1px solid var(--line);width:100%}
.sizes .size{padding:8px 12px;border:1px solid var(--line);border-radius:10px;background:#fff;color:#111;cursor:pointer}
.sizes .size.active,.sizes .size:hover{background:#111;color:#fff}
.qty{display:flex;align-items:center;gap:8px;margin:14px 0}
.qty__val{min-width:30px;text-align:center}

/* Cart Drawer */
.cart{position:fixed;top:0;right:0;height:100dvh;width:min(460px,96vw);background:#fff;border-left:1px solid var(--line); transform:translateX(100%);transition:.3s ease;z-index:80;display:flex;flex-direction:column}
.cart.open{transform:none}
.cart__head{display:flex;align-items:center;justify-content:space-between;padding:14px;border-bottom:1px solid var(--line)}
.cart__list{flex:1;overflow:auto;padding:10px 10px 120px;display:flex;flex-direction:column;gap:10px}
.line{display:grid;grid-template-columns:72px 1fr auto;gap:10px;align-items:center;border:1px solid var(--line);border-radius:12px;padding:8px}
.line .q{display:flex;align-items:center;gap:6px}
.line .q button{width:28px;height:28px;border-radius:8px;border:1px solid var(--line);background:#fff;color:#111}
.cart__foot{position:sticky;bottom:0;left:0;right:0;background:linear-gradient(180deg,rgba(255,255,255,.9),#fff);padding:12px;border-top:1px solid var(--line)}
.total{display:flex;justify-content:space-between;align-items:center;margin:8px 0 12px}
.total__sum{font-weight:800;font-size:20px}
.promo{font-size:13px;color:#6b7280}

/* Toasts */
.toast-wrap{position:fixed;right:16px;bottom:16px;display:flex;flex-direction:column;gap:8px;z-index:90}
.toast{background:#111;color:#fff;padding:10px 12px;border-radius:10px;box-shadow:var(--shadow);display:flex;align-items:center;gap:8px}
.toast.ok{background:var(--ok)}
.toast.warn{background:var(--warn)}
.toast.err{background:var(--err)}
</style>
</head>
<body>
<!-- TOPBAR -->
<div class="topbar" role="region" aria-label="Контакти и промо">
  <div class="container topbar__inner">
    <div><span class="brand-dot"></span> YOURFASHION • <a class="link" href="tel:+359889196281">+359 889 196 281</a> • <a class="link" href="mailto:support@yourfashion.bg">support@yourfashion.bg</a></div>
    <div>Безплатна доставка над 250 лв</div>
  </div>
</div>

<!-- HEADER -->
<header class="header">
  <div class="container header__inner">
    <a class="brand" href="#" aria-label="Начало">
      <div class="brand__logo" aria-hidden="true">YF</div>
      <div class="brand__text"><div class="brand__top">Your</div><div class="brand__bottom">Fashion</div></div>
    </a>
    <nav class="menu" id="mainMenu" aria-label="Главно меню">
      <a class="menu__link active" href="#bestsellers" data-nav="bestsellers">BESTSELLERS</a>
      <a class="menu__link" href="#new" data-nav="new">NEW</a>
      <a class="menu__link" href="#sale" data-nav="sale">ON SALE</a>
      <a class="menu__link" href="#products" data-nav="products">ПРОДУКТИ</a>
      <a class="menu__link" href="#blog" data-nav="blog">BLOG</a>
    </nav>
    <div class="header__actions">
      <label class="search" aria-label="Търсене">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><circle cx="11" cy="11" r="7" stroke="#64748b" stroke-width="2"/><path d="M20 20 L16.65 16.65" stroke="#64748b" stroke-width="2" stroke-linecap="round"/></svg>
        <input id="q" type="search" placeholder="Търси…" autocomplete="off" />
      </label>
      <button class="btn cart-btn" id="cartOpen" aria-haspopup="dialog" aria-controls="cart"> 🛒 Количка <span class="cart-btn__count" id="bagCount">0</span> </button>
      <button class="btn burger" id="burger" aria-expanded="false" aria-controls="mainMenu">☰</button>
    </div>
  </div>
</header>

<!-- GENDER -->
<section class="gender">
  <div class="container gender__grid">
    <a class="tile" href="#women" data-gender="women" aria-label="За нея">
      <span class="tile__label">ЗА НЕЯ</span>
      <img src="https://images.unsplash.com/photo-1515378791036-0648a3ef77b2?q=80&w=1400&auto=format&fit=crop" alt="">
      <div class="tile__bottom">
        <div>Щракнете бързо! Най-продаваните на разпродажба почти изчезнаха…</div>
        <div class="pill-row"><span class="pill">ДЕНИМ</span><span class="pill">ТЕНИСКИ</span><span class="pill">АКСЕСОАРИ</span><span class="pill">КОМПЛЕКТИ</span></div>
      </div>
    </a>
    <a class="tile" href="#men" data-gender="men" aria-label="За него">
      <span class="tile__label">ЗА НЕГО</span>
      <img src="https://images.unsplash.com/photo-1520975916090-3105956dac38?q=80&w=1400&auto=format&fit=crop" alt="">
      <div class="tile__bottom">
        <div>Бъдете силни, стилни и уникални с нашата мъжка колекция!</div>
        <div class="pill-row"><span class="pill">ТЕНИСКИ</span><span class="pill">ДЕНИМ</span><span class="pill">АКСЕСОАРИ</span><span class="pill">КОМПЛЕКТИ</span></div>
      </div>
    </a>
    <a class="tile tile--kid" href="#kids" data-gender="kids" aria-label="За детето">
      <span class="tile__label">ЗА ДЕТЕТО</span>
      <img src="https://images.unsplash.com/photo-1503457574464-0ec96d6a39d8?q=80&w=1600&auto=format&fit=crop" alt="">
      <div class="tile__bottom">
        <div>Весела и удобна колекция за най-малките.</div>
        <div class="pill-row">
          <span class="pill">СУИЧЪРИ</span>
          <span class="pill">КОМПЛЕКТИ</span>
          <span class="pill">ЕКИПИ</span>
        </div>
      </div>
    </a>
  </div>
</section>

<!-- INFO STRIP -->
<section class="info">
  <div class="container info__grid">
    <div class="ibox">🚚 <div><b>БЕЗПЛАТНА ДОСТАВКА</b><br/>над 250 лв. до офис на Еконт + тест и преглед</div></div>
    <div class="ibox">⚡ <div><b>БЪРЗА ОБРАБОТКА</b><br/>на всички поръчки направени през сайта</div></div>
    <div class="ibox">✅ <div><b>100% КАЧЕСТВО</b><br/>на всички артикули в онлайн магазина</div></div>
  </div>
</section>

<!-- PRODUCTS -->
<section class="section" id="shop">
  <div class="container">
    <div class="section__head">
      <h2 id="sectionTitle">BESTSELLER</h2>
      <div class="filters" aria-label="Филтри">
        <label>Сортирай: <select id="sort">
          <option value="new">Най-нови</option>
          <option value="price-asc">Цена: ниска → висока</option>
          <option value="price-desc">Цена: висока → ниска</option>
          <option value="sale">Най-голяма отстъпка</option>
        </select></label>
        <label>Размер: <select id="sizeFilter">
          <option value="all">Всички</option>
          <option>XS</option><option>S</option><option>M</option>
          <option>L</option><option>XL</option><option>2XL</option>
        </select></label>
        <label>Етикет: <select id="tagFilter">
          <option value="all">Всички</option>
          <option value="new">Ново</option>
          <option value="sale">Разпродажба</option>
        </select></label>
        <label>Категория: <select id="catFilter">
          <option value="all">Всички</option>
          <option value="women">Жени</option>
          <option value="men">Мъже</option>
          <option value="kids">Деца</option>
        </select></label>
        <button id="clearFilters" class="chip" title="Изчисти филтрите">Изчисти</button>
      </div>
    </div>

    <!-- GRID -->
    <div class="grid" id="grid" aria-live="polite"></div>

    <!-- SKELETONS (shown while boot) -->
    <div id="skeletons" class="grid">
      <div class="card"><div class="thumb skel"></div><div class="body"><div class="skel" style="height:18px;border-radius:8px"></div><div class="skel" style="height:14px;margin-top:8px;border-radius:8px"></div><div class="skel" style="height:24px;margin-top:10px;border-radius:8px"></div></div></div>
      <div class="card"><div class="thumb skel"></div><div class="body"><div class="skel" style="height:18px;border-radius:8px"></div><div class="skel" style="height:14px;margin-top:8px;border-radius:8px"></div><div class="skel" style="height:24px;margin-top:10px;border-radius:8px"></div></div></div>
      <div class="card"><div class="thumb skel"></div><div class="body"><div class="skel" style="height:18px;border-radius:8px"></div><div class="skel" style="height:14px;margin-top:8px;border-radius:8px"></div><div class="skel" style="height:24px;margin-top:10px;border-radius:8px"></div></div></div>
      <div class="card"><div class="thumb skel"></div><div class="body"><div class="skel" style="height:18px;border-radius:8px"></div><div class="skel" style="height:14px;margin-top:8px;border-radius:8px"></div><div class="skel" style="height:24px;margin-top:10px;border-radius:8px"></div></div></div>
    </div>
  </div>
</section>

<!-- INSTAGRAM -->
<section class="insta">
  <div class="container insta__inner">
    <div class="insta__head"><strong>@yourfashion</strong><span class="muted">Не изпускай намаленията – следвай ни.</span></div>
    <div class="insta__row" id="instaRow"></div>
  </div>
</section>

<!-- NEWSLETTER -->
<section class="newsletter">
  <div class="container newsletter__inner">
    <div>
      <h3>Don’t miss out on a sale again.</h3>
      <div class="muted">Sign up now for sale alerts & special offers.</div>
    </div>
    <form id="newsletterForm">
      <label class="visually-hidden" for="nlEmail">Email</label>
      <input id="nlEmail" type="email" placeholder="Вашият имейл" required />
      <button type="submit" class="btn">Абонирай ме</button>
    </form>
  </div>
</section>

<!-- FOOTER -->
<footer class="footer">
  <div class="container footer__grid">
    <div>
      <div class="f-title">YOURFASHION</div>
      <div class="muted">Модерни колекции от подбрани производители. Качество, комфорт и стил за всеки ден.</div>
      <div class="muted" style="margin-top:8px">Bulgaria • <a class="f-link" href="tel:+359889196281">+359 889 196 281</a> • <a class="f-link" href="mailto:support@yourfashion.bg">support@yourfashion.bg</a></div>
    </div>
    <div>
      <div class="f-title">За нас</div>
      <a class="f-link" href="#">Изпращане</a>
      <a class="f-link" href="#">Замяна и връщане</a>
      <a class="f-link" href="#">Общи условия</a>
      <a class="f-link" href="#">Контакти</a>
    </div>
    <div>
      <div class="f-title">Категории</div>
      <a class="f-link" href="#women" data-gender="women">За нея</a>
      <a class="f-link" href="#men" data-gender="men">За него</a>
      <a class="f-link" href="#kids" data-gender="kids">Деца</a>
      <a class="f-link" href="#" data-cat="accessories">Аксесоари</a>
    </div>
    <div>
      <div class="f-title">Помощ</div>
      <a class="f-link" href="#">ЧЗВ</a>
      <a class="f-link" href="#">Доставка</a>
      <a class="f-link" href="#">Политика за поверителност</a>
    </div>
  </div>
  <div class="copy">© <span id="year"></span> YourFashion. All rights reserved.</div>
</footer>

<!-- MODAL: Quick View -->
<div class="modal" id="modal" aria-hidden="true">
  <div class="modal__backdrop" id="modalBackdrop" tabindex="-1"></div>
  <div class="modal__card" role="dialog" aria-modal="true" aria-labelledby="mTitle">
    <div class="modal__head">
      <strong id="mTitle">Продукт</strong>
      <button class="btn btn--ghost" id="modalClose" aria-label="Затвори">✕</button>
    </div>
    <div class="modal__grid">
      <div class="modal__media"><img id="mImg" alt=""></div>
      <div class="modal__info">
        <div class="muted" id="mMeta"></div>
        <div class="price price--lg"><div id="mPrice" class="price__now"></div><div id="mOld" class="price__old"></div></div>
        <div class="muted" style="margin:10px 0 6px">Размер</div>
        <div class="sizes" id="mSizes"></div>
        <div class="qty"><button id="minus" class="btn btn--ghost" aria-label="Минус количество">–</button><div id="qty" class="qty__val">1</div><button id="plus" class="btn btn--ghost" aria-label="Плюс количество">+</button></div>
        <div class="buy-row" style="display:flex;gap:10px">
          <button class="btn btn--accent flex-1" id="addToCart">Добави в кошницата</button>
          <button class="btn flex-1" id="buyNow">Купи сега</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- CART DRAWER -->
<aside class="cart" id="cart" aria-live="polite" aria-label="Кошница">
  <div class="cart__head">
    <strong>Кошница</strong>
    <button class="btn btn--ghost" id="cartClose" aria-label="Затвори кошницата">✕</button>
  </div>
  <div class="cart__list" id="cartList"></div>
  <div class="cart__foot">
    <div class="promo" id="promoText">Добави още, за да хванеш безплатната доставка.</div>
    <div class="total"><div>Общо</div><div class="total__sum" id="total">0.00 лв</div></div>
    <button class="btn btn--accent w-100" id="checkout">Към плащане</button>
  </div>
</aside>

<!-- TOASTS -->
<div class="toast-wrap" id="toasts" aria-live="assertive" aria-atomic="true"></div>

<script>
/* ================== ДАННИ (примерни) ================== */
const PRODUCTS = [
  {id:'wf-001', title:'Дамски дънки „LOEWE“', cat:'women', type:'denim', price:159.00, old:169.00, tag:'sale', img:'https://images.unsplash.com/photo-1542272604-787c3835535d?q=80&w=1200&auto=format&fit=crop', sizes:['S','M','L','XL']},
  {id:'wf-002', title:'Дамски дънки „Miu“', cat:'women', type:'denim', price:149.00, old:169.00, tag:'sale', img:'https://images.unsplash.com/photo-1488900128323-21503983a07e?q=80&w=1200&auto=format&fit=crop', sizes:['S','M','L','XL']},
  {id:'wf-003', title:'Дамски деним „Alexander“', cat:'women', type:'denim', price:169.00, old:null, tag:'new', img:'https://images.unsplash.com/photo-1520975609630-4b36a7ac5ef2?q=80&w=1200&auto=format&fit=crop', sizes:['S','M','L','XL']},
  {id:'wf-004', title:'Дамски дънки „PR“', cat:'women', type:'denim', price:169.00, old:null, tag:'new', img:'https://images.unsplash.com/photo-1539533113208-f6df8cc4c40f?q=80&w=1200&auto=format&fit=crop', sizes:['S','M','L','XL']},
  {id:'wf-005', title:'Дамски панталон „MINT“', cat:'women', type:'pants', price:75.00, old:null, tag:'new', img:'https://images.unsplash.com/photo-1490111718993-d98654ce6cf7?q=80&w=1200&auto=format&fit=crop', sizes:['S','M']},
  {id:'wf-006', title:'Дамски дънки „Boston“', cat:'women', type:'denim', price:89.00, old:null, tag:'new', img:'https://images.unsplash.com/photo-1519741497674-611481863552?q=80&w=1200&auto=format&fit=crop', sizes:['XS','S','M','L']},
  {id:'mf-101', title:'Мъжка тениска „Core Man“', cat:'men', type:'tee', price:39.00, old:49.00, tag:'sale', img:'https://images.unsplash.com/photo-1520975916090-3105956dac38?q=80&w=1200&auto=format&fit=crop', sizes:['M','L','XL']},
  {id:'mf-102', title:'Мъжки комплект „Street Duo“', cat:'men', type:'set', price:94.90, old:119.90, tag:'sale', img:'https://images.unsplash.com/photo-1544441893-675973e31985?q=80&w=1200&auto=format&fit=crop', sizes:['S','M','L']},
  {id:'mf-103', title:'Мъжки екип „Pulse“', cat:'men', type:'tracksuit', price:104.90, old:null, tag:'new', img:'https://images.unsplash.com/photo-1516253593875-bd7ba052fbc5?q=80&w=1200&auto=format&fit=crop', sizes:['M','L','XL']},
  {id:'kf-201', title:'Детски суичър „Spark“', cat:'kids', type:'hoodie', price:39.90, old:49.90, tag:'sale', img:'https://images.unsplash.com/photo-1520975609630-4b36a7ac5ef2?q=80&w=1200&auto=format&fit=crop', sizes:['XS','S','M']},
  {id:'kf-202', title:'Детски комплект „Play“', cat:'kids', type:'set', price:59.90, old:null, tag:'new', img:'https://images.unsplash.com/photo-1586974727483-9bdbf4a1e0a8?q=80&w=1200&auto=format&fit=crop', sizes:['S','M','L']},
  {id:'kf-203', title:'Детски екип „Sprint“', cat:'kids', type:'tracksuit', price:69.90, old:89.90, tag:'sale', img:'https://images.unsplash.com/photo-1602810318383-9f1da12eaf0e?q=80&w=1200&auto=format&fit=crop', sizes:['S','M','L']}
];
const FREE_SHIP = 250; // съвпада с топбара

/* ================== СЪСТОЯНИЕ ================== */
let state = { search:'', sort:'new', size:'all', tag:'all', cat:'all', gender:null, cart: JSON.parse(localStorage.getItem('yf_cart') || '[]') };

/* ================== ЕЛЕМЕНТИ ================== */
const grid = document.getElementById('grid');
const skeletons = document.getElementById('skeletons');
const bagCount = document.getElementById('bagCount');
const q = document.getElementById('q');
const sortSel = document.getElementById('sort');
const sizeFilter = document.getElementById('sizeFilter');
const tagFilter = document.getElementById('tagFilter');
const catFilter = document.getElementById('catFilter');
const clearFilters = document.getElementById('clearFilters');
const sectionTitle = document.getElementById('sectionTitle');
const modal = document.getElementById('modal');
const modalBackdrop = document.getElementById('modalBackdrop');
const modalClose = document.getElementById('modalClose');
const mTitle = document.getElementById('mTitle');
const mImg = document.getElementById('mImg');
const mMeta = document.getElementById('mMeta');
const mPrice = document.getElementById('mPrice');
const mOld = document.getElementById('mOld');
const mSizes = document.getElementById('mSizes');
const minusBtn = document.getElementById('minus');
const plusBtn = document.getElementById('plus');
const qtyEl = document.getElementById('qty');
const addToCartBtn = document.getElementById('addToCart');
const buyNowBtn = document.getElementById('buyNow');
const cart = document.getElementById('cart');
const cartOpen = document.getElementById('cartOpen');
const cartClose = document.getElementById('cartClose');
const cartList = document.getElementById('cartList');
const totalEl = document.getElementById('total');
const promoText = document.getElementById('promoText');
const burger = document.getElementById('burger');
const mainMenu = document.getElementById('mainMenu');
const toasts = document.getElementById('toasts');
const yearEl = document.getElementById('year');
yearEl.textContent = new Date().getFullYear();

/* ================== ХЕЛПЪРИ ================== */
const money = n => (n||0).toFixed(2) + ' лв';
const el = (tag, attrs={}, children=[]) => {
  const n = document.createElement(tag);
  Object.entries(attrs).forEach(([k,v])=>{
    if (k==='class') n.className = v;
    else if (k==='html') n.innerHTML = v;
    else if (k==='style') n.style.cssText = v;
    else n.setAttribute(k, v);
  });
  children.forEach(c=>n.appendChild(c));
  return n;
};
function toast(msg, type='ok', ttl=2200){
  const t = el('div',{class:'toast '+type, html: msg});
  toasts.appendChild(t);
  setTimeout(()=>{ t.remove(); }, ttl);
}

/* ================== ФИЛТРИРАНЕ / СОРТИРАНЕ ================== */
function filterProducts(){
  return PRODUCTS
    .filter(p => state.cat==='all' ? true : p.cat===state.cat)
    .filter(p => state.gender ? p.cat===state.gender : true)
    .filter(p => state.tag==='all' ? true : p.tag===state.tag)
    .filter(p => state.size==='all' || p.sizes.includes(state.size))
    .filter(p => p.title.toLowerCase().includes(state.search.toLowerCase()))
    .sort((a,b)=>{
      switch(state.sort){
        case 'price-asc': return a.price - b.price;
        case 'price-desc': return b.price - a.price;
        case 'sale': {
          const sa = a.old ? (a.old-a.price)/a.old : 0;
          const sb = b.old ? (b.old-b.price)/b.old : 0;
          return sb - sa;
        }
        default: return (b.tag==='new') - (a.tag==='new'); // new first
      }
    });
}

/* ================== РЕНДЪР ================== */
function drawGrid(){
  const list = filterProducts();
  grid.innerHTML = '';
  list.forEach(p=>{
    const card = el('article',{class:'card'});
    const th = el('div',{class:'thumb'});
    th.appendChild(el('img',{src:p.img,alt:p.title,loading:'lazy'}));
    if (p.tag==='sale') th.appendChild(el('div',{class:'badge badge--dark',html:'SALE'}));
    const body = el('div',{class:'body'});
    body.appendChild(el('div',{html:'<strong>'+p.title+'</strong>'}));
    const sizes = el('div',{class:'sizes',html:p.sizes.join(' ')});
    body.appendChild(sizes);
    const price = el('div',{class:'price'});
    price.appendChild(el('div',{class:'price__now',html:money(p.price)}));
    if (p.old) price.appendChild(el('div',{class:'price__old',html:money(p.old)}));
    body.appendChild(price);
    const cta = el('div',{class:'cta-row'});
    const view = el('button',{class:'btn-sm ghost',html:'Бърз поглед', 'aria-label':'Бърз поглед'});
    const add = el('button',{class:'btn-sm',html:'Добави в количка'});
    view.onclick = ()=>openModal(p);
    add.onclick = ()=>addToCart(p, p.sizes[0], 1);
    cta.append(view,add);
    card.append(th,body,cta);
    grid.appendChild(card);
  });
}

/* ================== МОДАЛ ================== */
let modalProduct = null, modalQty = 1, modalSize = null;
function openModal(p){
  modalProduct = p;
  modalQty = 1;
  modalSize = p.sizes[0];
  mTitle.textContent = p.title;
  mImg.src = p.img;
  mImg.alt = p.title;
  mMeta.textContent = (p.cat==='women'?'За нея':p.cat==='men'?'За него':'Деца');
  mPrice.textContent = money(p.price);
  mOld.textContent = p.old ? money(p.old) : '';
  mSizes.innerHTML = '';
  p.sizes.forEach(s=>{
    const b = el('button',{class:'size'+(s===modalSize?' active':''),html:s});
    b.onclick = ()=>{ modalSize = s; [...mSizes.children].forEach(x=>x.classList.remove('active')); b.classList.add('active'); };
    mSizes.appendChild(b);
  });
  qtyEl.textContent = modalQty;
  modal.classList.add('open');
  modal.setAttribute('aria-hidden','false');
  modalClose.focus();
}
function closeModal(){
  modal.classList.remove('open');
  modal.setAttribute('aria-hidden','true');
}
modalBackdrop.onclick = closeModal;
modalClose.onclick = closeModal;
document.addEventListener('keydown',(e)=>{
  if(e.key==='Escape' && modal.classList.contains('open')) closeModal();
  if(e.key==='Escape' && cart.classList.contains('open')) closeCart();
});
minusBtn.onclick = ()=>{ modalQty = Math.max(1, modalQty-1); qtyEl.textContent = modalQty; };
plusBtn.onclick = ()=>{ modalQty++; qtyEl.textContent = modalQty; };
addToCartBtn.onclick = ()=>{ if(modalProduct){ addToCart(modalProduct, modalSize, modalQty); closeModal(); openCart(); } };
buyNowBtn.onclick = ()=>{ if(modalProduct){ addToCart(modalProduct, modalSize, modalQty); closeModal(); openCart(); } };

/* ================== КОШНИЦА ================== */
cartOpen.onclick = openCart;
cartClose.onclick = closeCart;
function openCart(){ cart.classList.add('open'); }
function closeCart(){ cart.classList.remove('open'); }
function saveCart(){ localStorage.setItem('yf_cart', JSON.stringify(state.cart)); }
function cartCount(){ return state.cart.reduce((a,i)=>a+i.qty,0); }
function cartTotal(){ return state.cart.reduce((a,i)=>a+i.price*i.qty,0); }
function addToCart(p, size, qty){
  const key = p.id+'_'+size;
  const line = state.cart.find(i=>i.key===key);
  if(line) line.qty += qty; else state.cart.push({ key, id:p.id, title:p.title, size, price:p.price, img:p.img, qty });
  saveCart();
  updateCartUI();
  toast('Добавено в кошницата ✔️','ok');
}
function removeFromCart(key){
  state.cart = state.cart.filter(i=>i.key!==key);
  saveCart();
  updateCartUI();
  toast('Премахнато от кошницата','warn');
}
function changeQty(key, delta){
  const line = state.cart.find(i=>i.key===key);
  if(!line) return;
  line.qty += delta;
  if(line.qty<=0) return removeFromCart(key);
  saveCart();
  updateCartUI();
}
function updateCartUI(){
  bagCount.textContent = cartCount();
  cartList.innerHTML = '';
  if(state.cart.length===0){
    cartList.appendChild(el('div',{class:'muted',html:'Кошницата е празна.'}));
  }
  state.cart.forEach(i=>{
    const row = el('div',{class:'line'});
    row.appendChild(el('img',{src:i.img,alt:i.title,style:'width:72px;height:72px;object-fit:cover;border-radius:10px'}));
    const mid = el('div');
    mid.appendChild(el('div',{html:i.title,style:'font-weight:600'}));
    mid.appendChild(el('div',{class:'muted',html:'Размер: '+i.size}));
    const right = el('div');
    right.appendChild(el('div',{html:money(i.price),style:'font-weight:700;text-align:right'}));
    const q = el('div',{class:'q'});
    const minus = el('button',{html:'–', 'aria-label':'Намали количество'});
    minus.onclick=()=>changeQty(i.key,-1);
    const qty = el('div',{html:i.qty,style:'min-width:22px;text-align:center'});
    const plus = el('button',{html:'+', 'aria-label':'Увеличи количество'});
    plus.onclick=()=>changeQty(i.key,1);
    q.append(minus, qty, plus);
    const del = el('button',{class:'btn btn--ghost',html:'Премахни'});
    del.onclick=()=>removeFromCart(i.key);
    right.append(q, del);
    row.appendChild(mid);
    row.appendChild(right);
    cartList.appendChild(row);
  });
  const total = cartTotal();
  totalEl.textContent = money(total);
  const need = Math.max(0, FREE_SHIP - total);
  promoText.textContent = need>0 ? `Добави още за ${money(need)} за безплатна доставка.` : 'Имаш безплатна доставка! 🎉';
}

/* ================== ТЪРСЕНЕ/ФИЛТРИ ================== */
q.addEventListener('input', e=>{ state.search = e.target.value.trim(); drawGrid(); });
sortSel.onchange = ()=>{ state.sort = sortSel.value; drawGrid(); };
sizeFilter.onchange = ()=>{ state.size = sizeFilter.value; drawGrid(); };
tagFilter.onchange = ()=>{ state.tag = tagFilter.value; drawGrid(); };
catFilter.onchange = ()=>{ state.cat = catFilter.value; state.gender=null; drawGrid(); };
clearFilters.onclick = ()=>{
  state.search=''; state.sort='new'; state.size='all'; state.tag='all'; state.cat='all'; state.gender=null;
  q.value=''; sortSel.value='new'; sizeFilter.value='all'; tagFilter.value='all'; catFilter.value='all';
  drawGrid();
};

/* ================== НАВИГАЦИЯ / ХЕШ РУТИНГ ================== */
document.querySelectorAll('[data-gender]').forEach(el=>{
  el.addEventListener('click',(e)=>{
    e.preventDefault();
    state.gender = el.dataset.gender;
    state.cat='all'; catFilter.value='all';
    drawGrid();
    window.location.hash = el.dataset.gender;
    smoothToShop();
  });
});

document.querySelectorAll('.menu__link').forEach(a=>{
  a.addEventListener('click',(e)=>{
    document.querySelectorAll('.menu__link').forEach(x=>x.classList.remove('active'));
    a.classList.add('active');
    switch(a.dataset.nav){
      case 'bestsellers': sectionTitle.textContent='BESTSELLER'; state.tag='all'; break;
      case 'new': sectionTitle.textContent='NEW'; state.tag='new'; break;
      case 'sale': sectionTitle.textContent='ON SALE'; state.tag='sale'; break;
      case 'products': sectionTitle.textContent='ПРОДУКТИ'; state.tag='all'; break;
      case 'blog': sectionTitle.textContent='BLOG'; break;
    }
    tagFilter.value = state.tag;
    drawGrid();
    smoothToShop();
  });
});

function smoothToShop(){
  const elShop = document.getElementById('shop');
  if(!elShop) return;
  const y = elShop.getBoundingClientRect().top + window.scrollY - 90;
  window.scrollTo({ top: y, behavior:'smooth' });
}

/* Mobile burger */
burger.addEventListener('click', ()=>{
  const open = mainMenu.style.display==='flex';
  mainMenu.style.display = open ? 'none':'flex';
  burger.setAttribute('aria-expanded', String(!open));
});
// Close menu on link click (mobile UX)
mainMenu.querySelectorAll('a').forEach(a=>a.addEventListener('click',()=>{
  if (window.innerWidth <= 980){
    mainMenu.style.display='none';
    burger.setAttribute('aria-expanded','false');
  }
}));

/* ================== ИНСТАГРАМ (демо) ================== */
const instaRow = document.getElementById('instaRow');
const INSTAGRAM_IMGS = [
  'https://images.unsplash.com/photo-1520975609630-4b36a7ac5ef2?q=80&w=600&auto=format&fit=crop',
  'https://images.unsplash.com/photo-1490481651871-ab68de25d43d?q=80&w=600&auto=format&fit=crop',
  'https://images.unsplash.com/photo-1519741497674-611481863552?q=80&w=600&auto=format&fit=crop',
  'https://images.unsplash.com/photo-1520975916090-3105956dac38?q=80&w=600&auto=format&fit=crop',
  'https://images.unsplash.com/photo-1544441893-675973e31985?q=80&w=600&auto=format&fit=crop',
  'https://images.unsplash.com/photo-1520975618319-2208d157c9e2?q=80&w=600&auto=format&fit=crop'
];
function drawInstagram(){
  instaRow.innerHTML='';
  INSTAGRAM_IMGS.forEach(src=>instaRow.appendChild(el('img',{src,alt:'@yourfashion',loading:'lazy'})));
}

/* ================== NEWSLETTER (демо) ================== */
document.getElementById('newsletterForm').addEventListener('submit', (e)=>{
  e.preventDefault();
  const email = document.getElementById('nlEmail').value.trim();
  if(!email){ return; }
  toast('Абонаментът е активен. Добре дошъл!','ok');
  e.target.reset();
});

/* ================== CHECKOUT (демо) ================== */
document.getElementById('checkout').addEventListener('click', ()=>{
  if(state.cart.length===0){
    toast('Кошницата е празна. Добави продукти 🙂','warn');
    return;
  }
  alert('ДЕМО checkout — тук ще се свърже истинското плащане/поръчка.');
});

/* ================== ХЕШ ИНИЦИАЛИЗАЦИЯ ================== */
function applyHash(){
  const h = (location.hash||'').replace('#','');
  if(['women','men','kids'].includes(h)){
    state.gender = h; drawGrid(); smoothToShop();
  }
  if(h==='sale'){ state.tag='sale'; tagFilter.value='sale'; sectionTitle.textContent='ON SALE'; drawGrid(); smoothToShop(); }
  if(h==='new'){ state.tag='new'; tagFilter.value='new'; sectionTitle.textContent='NEW'; drawGrid(); smoothToShop(); }
}

/* ================== BOOT ================== */
function boot(){
  drawGrid();
  updateCartUI();
  drawInstagram();
  skeletons.style.display='none';
  applyHash();
}

document.addEventListener('DOMContentLoaded', boot);
</script>
</body>
</html>
